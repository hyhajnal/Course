<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <script type="text/javascript" src="jquery-easyui-1.4.3/jquery.min.js" charset="utf-8"></script>
    <script type="text/javascript" src="jquery-easyui-1.4.3/jquery.easyui.min.js" charset="utf-8"></script>
    <script type="text/javascript" src="jquery-easyui-1.4.3/easyloader.js"></script>
    <link rel="stylesheet" href="jquery-easyui-1.4.3/themes/default/easyui.css" type="text/css"></link>
  
    <link rel="stylesheet" href="jquery-easyui-1.4.3/themes/icon.css" type="text/css"></link>
    <script type="text/javascript" src="jquery-easyui-1.4.3/locale/easyui-lang-zh_CN.js" charset="utf-8"></script>
    <script type="text/javascript" charset="utf-8">
        var url;
        var type;
        function newuser() {
            $("#dlg").dialog("open").dialog('setTitle', '添加学生'); ;
            $("#fm").form("clear");
            url = "./addStu.do";
            document.getElementById("hidtype").value="submit";
        }
        function edituser() {
            var row = $("#dg").datagrid("getSelected");
            if (row) {
                $("#dlg").dialog("open").dialog('setTitle', '修改学生信息');
                $("#fm").form("load", row);
                url = "./editStu.do";
            }
        }
        function saveuser() {
            $("#fm").form("submit", {
                url: url,
                onsubmit: function () {
                    return $(this).form("validate");
                },
                success: function (result) {
               // $.messager.alert(result);
                    if (result == "1") {
                        $.messager.alert("提示信息", "操作成功");
                        $("#dlg").dialog("close");
                        $("#dg").datagrid("load");
                    }
                    else {
                        $.messager.alert("提示信息", "操作失败");
                    }
                } 
            });
        } 
        function destroyUser() {       					
            var row = $('#dg').datagrid('getSelected');
            var data={"sno":row.sno};
           // $.messager.alert(row.sname);
            if (row) {
                $.messager.confirm('确认', '你确定删除这个用户?', function (r) {
                    if (r) {
                       $.ajax({
						      type: "post",
						      contentType:"application/json",
						      url: "./deleteStu.do",
						      dataType: "json",
						      data:JSON.stringify(data),
						      success: function(data){
						        	if(!data.success){
								        $.messager.show({ 
		                                    title: 'Error',
		                                    msg: result.errorMsg
		                                });
						        	}else{
						          $.messager.alert("成功");
						          $('#dg').datagrid('reload');
						           }
						           }
						       });
						      
						      }
						 });
                      }
        } 
    </script>

</head>
<body>

    <div id="tb" style="padding:5px;height:auto">  
        <div style="margin-bottom:5px">  
         <a href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" id="add" plain="true" onclick="newuser()">添加</a> 
         <a href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-edit" id="edit" plain="true" onclick="edituser()">修改</a>
         <a href="javascript:void(0)" class="easyui-linkbutton"  iconcls="icon-remove" plain="true" onclick="destroyUser()"  >删除</a>
        </div>  
    </div>  
        <table id="dg" class="easyui-datagrid"  
    		   url="./queryStuList.do"   
    		   title="" toolbar="#tb"  
               singleSelect="true"
               fitColumns="true" fit="true" 
               border="false"
               
                >  
        <thead>  
        <tr>  
  			<th field="sno" width="60" checkbox="true">学号</th>           
            <th field="sname" width="80">姓名</th>  
            <th field="sage" align="right" width="70">年龄</th>  
            <th field="ssex" align="right" width="70">性别</th>  
            <th field="spass" width="200">密码</th>    
        </tr>  
        </thead>  
    </table>  
    
    <div id="dlg" class="easyui-dialog" style="width: 400px; height: 320px; padding: 10px 20px;text-align:center;"
       closed="true" buttons="#dlg-buttons"> 
       <div class="ftitle"> 
      		  <h3> 学生信息</h3> 
       </div> 
       <form id="fm" method="post"> 
       <div class="fitem"> 
           <label> 
        	       学号 
           </label> 
           <input name="sno" class="easyui-validatebox" required="true" /> 
       </div> 
       <br>
       <div class="fitem"> 
           <label>姓名</label> 
           <input name="sname" class="easyui-validatebox" required="true" /> 
       </div> 
       <br>
       <div class="fitem"> 
           <label>年龄</label> 
           <input name="sage" class="easyui-validatebox" required="true" /> 
       </div> 
       <br>
       <div class="fitem"> 
           <label>密码</label> 
           <input name="spass" class="easyui-validatebox" required="true" /> 
       </div> 
       <br>
       <div class="fitem"> 
           <label>性别</label> 
           <select class="easyui-combobox" name="ssex"  >	
           		<option value="男">男</option>
           		<option value="女">女</option> 
           </select>
           <label>专业</label> 
           <select class="easyui-combobox" name="did"  >	
           		<option value="Aa">计科</option>
           		<option value="Ab">电子</option> 
           		<option value="Ac">数媒</option>
           </select>
       </div> 
 
       <input type="hidden" name="action" id="hidtype" /> 
       <input type="hidden" name="ID" id="Nameid" /> 
       </form> 
   </div>
?<div id="dlg-buttons"> 
        <a href="javascript:void(0)" class="easyui-linkbutton" onclick="saveuser()" iconcls="icon-save">保存</a> 
        <a href="javascript:void(0)" class="easyui-linkbutton" onclick="javascript:$('#dlg').dialog('close')"
            iconcls="icon-cancel">取消</a> 
    </div> 
</body>
</html>

  

